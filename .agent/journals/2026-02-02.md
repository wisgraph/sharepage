# 개발 저널: 2026-02-02

## 📅 오늘 진행한 작업
- **[Refactor] 키보드 액션 시스템 강화**:
    - `ActionDefinition`에 `precondition` 로직 도입.
    - 메인 검색창(`main-search-input`)에 포커스가 있을 때만 특정 전역 단축키가 동작하도록 제어하여 인풋 충돌 문제 해결.
- **[Refactor] 뷰 내비게이션 통합**:
    - `appOrchestrator`에 `NAVIGATE` 이벤트를 통합하여 `ViewMode` 전환 로직을 단일 채널로 개선.
- **[Bug] 아이콘 로딩 오류 수정**:
    - 가상 시스템 항목("Galpi System")에 대한 불필요한 아이콘 요청 차단.
    - 아이콘 추출 실패 시 발생하는 비치명적 에러가 전역 Toast 알림으로 뜨지 않도록 `apiClient` 레벨에서 필터링 및 조용히 처리(`isSilent` 옵션).
- **[Bug] 정규표현식 크래시 해결**:
    - 검색창에 `\` 등 특수문자 입력 시 `hangul-js` 내부 라이브러리에서 발생하는 `SyntaxError`를 `textService` 레벨에서 `try-catch`로 방어.
- **[DX] 개발 편의성 개선**:
    - HMR(Hot Module Replacement) 발생 시 단축키 보관소의 중복 등록 경고 메시지 제거.
- **[UX] 다이얼로그 애니메이션 최적화**:
    - `GlobalDialog.svelte`의 `transition:fade` 제거로 배경 깜빡임 버그 수정.
    - 다이얼로그 닫힘 애니메이션 속도를 300ms → 150ms로 개선하여 "미친 속도" 정체성 강화.
- **[Feature] 가중치 조절 키보드 단축키 추가**:
    - `Meta+ArrowUp` / `Meta+ArrowDown`으로 아이템 가중치 증감 기능 구현.
    - 가중치 변경 후 자동 정렬 시 포커스 추적 기능 추가 (`targetId` 기반).
- **[UX] 마우스 가중치 조절 UI 개선**:
    - 호버 시 확장되는 `[숫자 | -]` 패턴으로 재디자인.
    - 숫자 클릭 시 증가, `-` 버튼 클릭 시 감소하는 직관적인 인터랙션 구현.
- **[Bug] 윈도우 드래그 버그 수정**:
    - `Launcher.svelte`의 드래그 감지 로직에 5px 임계값 추가.
    - 클릭만 했을 때 윈도우가 마우스 위치로 순간이동하는 버그 해결.
- **[Feature] 독 아이콘 표시 및 캡처 기능 (New)**:
    - 사용자가 설정에서 독 아이콘 표시 여부를 선택 가능 (`Regular` / `Accessory` 모드 전환).
    - **AppTracker 구현**: 백그라운드에서 Galpi가 아닌 최신 앱 정보를 추적하는 로직 추가.
    - **스마트 캡처**: 독 아이콘 클릭 시 `RunEvent::Reopen` 이벤트를 감지하고, AppTracker에 저장된 '이전 앱' 정보로 캡처 수행. (Galpi가 자기 자신을 캡처하는 문제 해결)
    - 한국어/영어 로케일 및 설정 UI 업데이트.
- **[Refactor] 저장 후 캡처 컨텍스트 유지 전략 구현**:
    - 저장 후 검색 리스트로 이동하는 대신, 캡처 카드를 유지하며 `CAPTURE_EXISTING` 상태로 전환하는 자연스러운 UX 구현.
    - 리스트 0번 강제 주입(Always Top Boost) 로직을 제거하여 복잡도와 기술 부채 해소.
- **[Feature] 캡처 카드 내 가중치 조절 UI 추가**:
    - `MouseWeight` 컴포넌트를 재사용하여 저장 직후 캡처 카드에서 바로 가중치를 변경할 수 있도록 개선.
- **[Bug] 캡처 카드-리스트 간 데이터 불일치 해결**:
    - 가중치 변경 시 리스트와 캡처 카드 정보를 동시에 낙관적으로 업데이트하여 시각적 불일치 제거.
    - 백엔드 동기화 이벤트(`GALPI_UPDATED`)에 최신 정보를 포함시켜 전역 상태 무결성 강화.

## 🕒 07:48 작업 기록
- **[Refactor] 저장 UX 및 데이터 동기화 최적화**:
    - 캡처 카드 유지 전략 도입으로 저장 후 맥락 끊김 현상 해결.
    - `galpiDataController` 내 중첩 에러 핸들링 및 불필요한 Boost 로직 제거로 코드 정비.
    - 가중치 조절 시 실시간 양방향(리스트-카드) 데이터 동기화 구현.

## 🕒 08:27 작업 기록
- **[Feature] 설정 화면 태그 검색 UI 개선**:
    - 컨텍스트 타입 추가 UI를 '버튼 클릭' 방식에서 **'검색 입력창(Input Trigger)'** 방식으로 전면 개편.
    - 입력창에 포커스하거나 타이핑하면 즉시 자동완성 드롭다운이 열리도록 UX 향상.
    - 실시간 검색 필터링 및 키보드 네비게이션(화살표/엔터) 완벽 지원.
    - 태그 선택 시 입력창 자동 초기화로 연속 추가 편의성 제공.

## 🕒 09:10 작업 기록
- **[Feature] 다국어(i18n) 지원 강화**:
    - 모든 다이얼로그(GlobalDialog, UpdateStatusOverlay) 및 알림 메시지에서 하드코딩된 한국어를 제거하고 `localeService`를 통한 다국어 지원 구현.
    - 업데이트 완료 알림 제목이 영어에서 "Error"로 표시되던 버그를 `common.alert` 키 도입으로 해결.
    - 삭제 확인, 누락 파일 제거 확인 등 주요 컨펌 메시지도 로케일 설정에 따라 자동 전환되도록 개선.
- **[UX] 컨텍스트 메뉴 마우스 사용성 개선**:
    - 마우스 사용자를 위해 컨텍스트 메뉴 박스 바로 상단에 **컴팩트한 닫기 버튼(X)** 추가.
    - 평소에는 무채색으로 유지하다가 호버 시에만 빨간색으로 변하는 프리미엄 스타일 적용.
    - 메뉴 박스 내부의 단축키 힌트를 가리지 않도록 위치를 상단 외부로 미세 조정.
    - 외부 영역 클릭 시에도 메뉴가 자연스럽게 닫히도록 유도.

## 🗒 기록 사항 / 문제점
- 아이콘 추출 실패(404)는 외부 서비스(Google Favicon) 응답 문제이므로 앱 레벨에서 크래시만 막으면 됨.
- `apiClient`의 `console.error`조차 소음이 될 수 있는 빈번한 에러는 내부적으로 무시하도록 구조 변경 완료.
- 가중치 조절 UI는 여러 시도 끝에 호버 확장 패턴으로 정착. 추후 사용자 피드백 모니터링 필요.
- **AppTracker**: macOS의 `frontmostApplication` API를 활용해 0.5초 간격으로 폴링하며 앱 전환을 감지함. Galpi가 포커스를 받을 때 이전 앱 정보를 유실하지 않도록 보완함.
- **저장 UX**: 저장 후 리스트로 이동하는 방식은 정렬 로직과의 충돌로 인해 관리가 어려웠으나, 캡처 컨텍스트를 유지하는 방식으로 전환하며 근본적인 문제 해결 및 UX 향상.
- **i18n**: `MESSAGES` 상수에 의존하던 기존 방식에서 `localeService.t` 동적 호출 방식으로 전환하여 런타임 언어 변경에도 즉각 대응 가능하도록 체계화함.

## 🚀 다음 계획
- UI 디테일 개선 및 캡처 성능 최적화.
- 사용되지 않는 레거시 코드 정리.
- 백엔드 단축키 초기화 시 `center()` 호출 로직 개선 (첫 실행 시에만).
- 전체적인 애니메이션 곡선(Easing) 조정으로 더 쫀득한 조작감 구현.
